Maszyna stosowa

Napisz program wykonuj¹cy nastêpuj¹ce operacje na stosie liczb ca³kowitych. Stos powinien byæ zaimplementowany jako lista jednokierunkowa.
liczba
w³o¿enie na stos danej liczby
p
wypisanie stosu (od wierzcho³ka do spodu)
s
zamiana miejscami dwóch liczb na szczycie stosu
x
usuniêcie elementu ze szczytu stosu
+
zdjêcie dwóch liczb ze stosu i w³o¿enie na stos ich sumy
r
zdjêcie ze stosu liczby n, przeniesienie liczby z wierzcho³ka stosu na n-te miejsce licz¹c od wierzcho³ka; 0 r oraz 1 r nic nie robi, 2 r jest to¿same z s, 3 r zamienia 3 2 1 na 2 1 3 itd.
q
zakoñczenie programu
Uwaga: operacje s i r mog¹ modyfikowaæ jedynie wskaŸniki.
Wejœcie

Na wyjœciu zostanie podany ci¹g poleceñ. Ka¿de polecenie bêdzie sk³ada³o siê z jednego znaku.
Wyjœcie

Na wyjœcie nale¿y wypisaæ wynik poleceñ p, rozdzielaj¹c je znakami nowej linii.
Przyk³ad

Wejœcie
1 p
2 p
3 p
4 p
5 p
x p
x p
x p
x p
x p
1 2 3 4 5 p
+ p
+ p
+ p
+ p
x p
1 2 3 4 5 p
s p
s p
1 r p
2 r p
2 r p
3 r p
3 r p
3 r p
4 r p
4 r p
4 r p
4 r p
5 r p
5 r p
5 r p
5 r p
5 r p
q

Wyjœcie
1 
2 1 
3 2 1 
4 3 2 1 
5 4 3 2 1 
4 3 2 1 
3 2 1 
2 1 
1 

5 4 3 2 1 
9 3 2 1 
12 2 1 
14 1 
15 

5 4 3 2 1 
4 5 3 2 1 
5 4 3 2 1 
5 4 3 2 1 
4 5 3 2 1 
5 4 3 2 1 
4 3 5 2 1 
3 5 4 2 1 
5 4 3 2 1 
4 3 2 5 1 
3 2 5 4 1 
2 5 4 3 1 
5 4 3 2 1 
4 3 2 1 5 
3 2 1 5 4 
2 1 5 4 3 
1 5 4 3 2 
5 4 3 2 1 
